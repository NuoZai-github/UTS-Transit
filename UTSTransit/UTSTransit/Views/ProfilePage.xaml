<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:UTSTransit.ViewModels"
             x:Class="UTSTransit.Views.ProfilePage"
             x:DataType="vm:ProfileViewModel"
             Title="Profile">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="30" VerticalOptions="Center">

            <Frame CornerRadius="50" 
                   HeightRequest="100" 
                   WidthRequest="100" 
                   HorizontalOptions="Center" 
                   Padding="0" 
                   IsClippedToBounds="True"
                   BorderColor="{StaticResource Primary}"
                   BackgroundColor="LightGray">
                <Grid>
                    <Image Source="{Binding UserAvatar}" Aspect="AspectFill" />
                    <!-- Camera icon removed to avoid obstructing the photo -->
                    <Grid.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding UploadAvatarCommand}" />
                    </Grid.GestureRecognizers>
                </Grid>
            </Frame>
            <Label Text="Tap to change avatar" FontSize="10" HorizontalOptions="Center" TextColor="Gray"/>

            <Label Text="{Binding FullName}"
                   Style="{StaticResource TitleLabel}"
                   HorizontalOptions="Center" />
            
            <Label Text="{Binding Role, StringFormat='Role: {0}'}"
                   HorizontalOptions="Center" TextColor="Gray" Margin="0,-10,0,10"/>

            <Border StrokeShape="RoundRectangle 8" Stroke="{AppThemeBinding Light={StaticResource Border}, Dark={StaticResource BorderDark}}" Padding="20" BackgroundColor="{AppThemeBinding Light={StaticResource PageBackground}, Dark={StaticResource SurfaceDark}}">
                <VerticalStackLayout Spacing="5">
                    <Label Text="Email Address" Style="{StaticResource SubtitleLabel}" />
                    <Label Text="{Binding UserEmail}" FontSize="18" TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark={StaticResource TextPrimaryDark}}" />
                </VerticalStackLayout>
            </Border>

            <Button Text="Sign out"
                    Command="{Binding LogoutCommand}"
                    BackgroundColor="Transparent"
                    TextColor="{StaticResource Error}"
                    BorderColor="{StaticResource Error}"
                    BorderWidth="1"
                    HeightRequest="50"
                    Margin="0,20,0,0" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
